<a name="---"></a><!---
---
實驗室：標題：「探索 Azure 原則」學習路徑/課程模組/單元：「學習路徑：描述 Microsoft 合規性的功能；課程模組 6：描述 Azure 中的資源控管功能；單元 2：描述 Azure 原則」
---
--->

# <a name="lab-explore-azure-policy"></a>實驗室：探索 Azure 原則

此實驗室對應至下列 Learn 內容：

- 學習路徑：描述 Microsoft 合規性的功能
- 課程模組：描述 Azure 中的資源控管功能
- 單元：描述 Azure 原則

## <a name="lab-scenario"></a>實驗案例

Azure 原則有助於強制執行組織標準並大規模評估合規性。 Azure 原則會將這些資源屬性與商務規則做比較，藉此評估 Azure 中的資源。 在本實驗中，您將建立原則並查看該原則的影響。  您也會依據原則頁面上可用的合規性和補救資訊進行探索。

**預估時間**：15-20 分鐘

### <a name="task-1"></a>工作 1

在這項工作中，您將建立基本原則指派以要求在資源群組上新增標記。
1.  開啟 Microsoft Edge。 在網址列輸入 **portal.azure.com**。

1. 使用 Azure 訂用帳戶的管理員認證登入 (這些管理員認證與 Microsoft 365 管理員認證不同)。
    1. 在登入視窗中輸入 **User1-XXXXXXXX@LODSPRODMSLEARNMCA.onmicrosoft.com** (其中的 XXXXXXXX 是實驗室託管提供者所提供的唯一租用戶識別碼)，然後選取 [下一步]。

    1. 輸入您的實驗室託管提供者提供的管理員密碼。 選取 [登入]。
    1. 出現提示要求您保持登入時，請選取 [是]。

1. 您現在位於 Azure 入口網站。  請在頁面上方寫著 Microsoft Azure 旁邊的藍色列搜尋方塊中輸入 **policy**，並從搜尋結果中選取**原則**。 這將開啟提供儀表板檢視的原則首頁。  [儀表板] 檢視的範圍是由授權實驗室託管服務提供者 (ALH) 所提供的 Azure 訂用帳戶。 您會看到一個原則列出，這是 ALH 所建立的原則，可供使用 Azure 訂用帳戶。

1. 在左側導覽面板的 [製作] 下方，選取**作業**。

1. 請在頁面上方選取**指派原則**。 指派原則精靈將啟動，引導管理員進行指派原則的流程。

1. 您會從 [基本] 索引標籤開始。
    1. 針對 [範圍]，保留預設設定。 在此情況下，原則的範圍是授權實驗室託管服務提供者 (ALH) 所提供的 Azure 訂用帳戶。
    1. 針對 [原則定義]，選取**省略符號**。  提供可用的原則定義清單。  在搜尋列中，輸入**需要標籤**。 在搜尋結果中選取**需要資源群組標籤** (可能需要往下捲動)，再按一下**選取**。  請注意：此原則的效用是 [拒絕] 建立任何不符合要求的新資源群組。  
    1. 請注意預設指派的名稱。  將名稱保持原樣。
    1. 確定 [原則強制執行] 已設定為 [已啟用]，然後選取 [下一步]。

1. 您現在位於 [參數] 索引標籤中。在 [標籤名稱] 欄位中，輸入**環境**，然後選取 [下一步]。

1. 在 [補救] 索引標籤中，讓預設設定保留原狀，然後選取 [下一步]。

1. 您現在位於 [不符合規範的訊息] 索引標籤中。在 [不符合規範的訊息] 欄位中，輸入**需要環境標籤**，然後選取 [下一步]。 請注意：若資源群組在原則指派前建立且沒有環境標籤，將出現此非合規性原因的訊息。

1. 檢閱原則指派，然後選取 [建立]。  如果未立即出現原則，請選取**重新整理**。 注意：原則可能需要長達 30 分鐘才能生效，但通常會進行得更快。

1. 請選取螢幕右上角的 **X** 離開 [原則指派] 頁面。

1. 您現在位於 Azure 服務首頁。  保持此頁面開啟，將會在下一個工作中使用。

### <a name="task-2"></a>工作 2

在這項工作中，嘗試在 Azure 中建立沒有標籤的資源群組，您會看到 Azure 原則指派的影響。

1. 開啟瀏覽器索引標籤的 [首頁 – Microsoft Azure]。

1. 在頁面上方的「Azure 服務」字樣下方選取**資源群組**。

1. 請在頁面左上角選取 **+ 建立**。

1. 在 [建立資源群組] 的 [基本] 索引標籤中，讓 [訂用帳戶] 欄位保留原狀。

1. 在 [資源群組] 欄位中輸入 **SC900-Labs**。

1. 保留 [區域] 設定的預設值，然後選取 [下一步：標籤]。

1. 標籤名稱與值的欄位保持空白。  請勿填寫，再選取**審閱 + 建立**。

1. 您會看到驗證通過訊息 (標籤名稱與值不是精靈中的必要欄位)，然後選取 [建立]。

1. 您會看到畫面頂端出現失敗訊息：「無法建立資源群組」。 選取**檢視錯誤詳細資料**。 未達成屬於 Azure 原則的條件，因此資源群組建立是基於非合規性原因而遭到封鎖。 注意：如果您沒有看到失敗訊息，並且已建立資源群組，這是因為原則尚未生效。  前往 [原則] 頁面，找到您先前的工作建立的原則，當原則生效時您就會看到該資源不符合規範。  詳細資料頁面將顯示非合規性訊息。

1. 錯誤摘要會顯示錯誤類型，[資源 SC900-Labs] 會被原則禁止。  請選取螢幕右上角的 **X** 關閉此視窗。

1. 從 [建立資源群組] 視窗，選取 [上一頁]。

1. 您已回到建立資源群組的標籤頁面。  請在 [名稱] 欄位中輸入 [環境]，然後在 [值] 欄位中輸入 **SC900-Labs**，再選取 [下一步：檢閱 + 建立 >]。

1. 驗證標籤並選取**建立**。

1. 在 [名稱] 欄位中輸入 [環境]，然後在 [值] 欄位中輸入**實驗室** (此值可能是任何值，原則只需要標籤值)，接著選取 [下一步：檢閱 + 建立>]，然後選取 [建立]。

1. 您將會看到列出的資源群組。  

1. 從頁面頂端的階層連結中選取 [首頁] 以返回 Azure 首頁。

1. 讓瀏覽器索引標籤保持開啟，您在下一個工作中需要它。

### <a name="task-3-optional"></a>工作 3 (選用)

在這項工作中，您將逐步解說補救不合規資源群組的步驟。 注意：用於實驗室的 Azure 訂用帳戶會經歷比正常還要長的延遲，以更新已補救資源群組的合規性狀態。

1. 從 Azure 首頁選取 [原則]。 這將開啟提供儀表板檢視的原則首頁。  [儀表板] 檢視的範圍是由授權實驗室託管服務提供者所提供的 Azure 訂用帳戶。  

1. 您應會看到您稍早建立的原則，請加以選取。

1. 在頁面頂部的 Essentials 下，可以查看名稱、說明和其他基本資訊。  請注意，原則會顯示為不符合規範。  請選取原則，以取得原則為何不符合規範的詳細資訊。 您可以在此看到列為 resourgegroup1 的資源不符合規範。  這是在建立原則之前所建立的資源群組範例。 如需詳細資訊，請選取 [詳細資料]。  您可以在此看到需要環境標籤的合規性訊息。  選取右上方的 **X** 以關閉視窗。

1. 選取 **resourcegroup1**，然後從頁面頂端選取 [檢視資源]。
    1. 在 [標記] 旁選取 [編輯]。
    1. 將滑鼠游標放在 [標籤] 欄位中，然後選取 [環境]。
    1. 將滑鼠游標放在 [值] 欄位中，選取 [實驗室]，然後選取 [儲存]。

1. 現在返回原則頁面。  將滑鼠游標放在頁面頂端的藍色搜尋方塊上，然後選取 [原則]。

1. 在左側導覽面板中，選取 [合規性]****。  與概覽頁面相同，您可以在此檢視已列出的原則和/或新措施的合規性狀態。  注意：雖然您已將標籤新增至資源群組，但狀態需要一段時間才能更新。  用於實驗用途的 Azure 訂用帳戶可能會經歷比正常還要長的延遲。 如果您想要等候此資源的合規性狀態更新，請勿結束實驗室。 視實驗室環境而定，可能需要一小時或更多時間才能更新。  

### <a name="review"></a>檢閱

在本實驗中，您已完成建立 Azure 原則指派的程序，而且您能看到該原則的影響。
